namespace = veneto_flavour_event

#veneto_flavour_event.1 = { #veneto occupies sparta - Event would require on_action - DISREGARD
#	type = province_event 
#	title = veneto_flavour_event.1.t
#	desc = veneto_flavour_event.1.desc
#	picture = greek_siege
#	
#	left_portrait = Owner.current_ruler
#
#	goto_location = p:427
#	
#	trigger = {
#		province_id = 427
#		owner = { 
#			has_civil_war = no
#			NOT = { 
#				has_variable = dhe_city_fall_14
#			} 
#			tag = VNT
#		}
#		p:427 = {
#			city_fall_trigger = yes
#		}
#	} 
#
#	immediate = {
#		p:427 = {
#			save_scope_as = special_province
#		}
#	}
#
#	option = { # Treat them nicely
#		name = "veneto_flavour_event.1.a"
#		merciful_ruler_effect = yes
#		p:427 = {
#			add_province_modifier = {
#			    name = me_benevolent_treatment_to_the_spartans_pmod
#			    duration = -1
#			}
#		}
#		c:VNT = {
#		    every_country_culture = {
#		        if = {
#    	    	    limit = { 
#    	    	        is_culture = peloponnesian
#    	    	    }
#    	    	set_country_culture_right = citizen
#    	        add_integration_progress = 1
#    	        }
#    	    }
#    	}
#	}
#
#	option = { # Bring a few things back home
#		name = "veneto_flavour_event.1.b"
#		neutral_conqueror_effect = yes
#	}
#
#	option = { # Sack the city
#		name = "veneto_flavour_event.1.c"
#		owner = {
#			add_country_modifier = {
#				name = country_improvement_spartan_discipline
#				duration = 3650
#			}
#		}
#		salt_earth_effect = yes
#	}
#}

veneto_flavour_event.2 = { #venetian empire declared
    type = country_event
    title = veneto_flavour_event.2.t
    desc = veneto_flavour_event.2.desc
    picture = oration

    option = {
        name = veneto_flavour_event.2.a
        change_country_name = VENETIC_EMPIRE
        change_country_adjective = VENETIC_EMPIRE_ADJ
        change_country_color = venetic_empire_color
        change_country_flag = VENETIC_EMPIRE_FLAG
        add_country_modifier = {
            name = ven_venetian_empire_cmod
            duration = 36500 #100 years
        }
        ROOT = {
            set_variable = {
                name = formed_venetian_empire
            }
        }
    }
}

veneto_flavour_event.3 = { #venetic league declared
    type = country_event
    title = veneto_flavour_event.3.t
    desc = veneto_flavour_event.3.desc
    picture = council_country

    option = {
        name = veneto_flavour_event.3.a
        change_country_name = VENETIC_LEAGUE
        change_country_adjective = VENETIC_LEAGUE_ADJ
        change_country_color = venetic_league_color
        change_country_flag = VENETIC_LEAGUE_FLAG
        add_country_modifier = {
            name = ven_venetic_league_cmod
            duration = 36500 #100 years
        }
        ROOT = {
            set_variable = {
                name = formed_venetic_league
            }
        }
    }	
}

veneto_flavour_event.4 = { #Rome borders Veneto
    type = country_event
    hidden = yes

    trigger = {
        c:ROM = {
            has_land = yes
        }
        root = {
            AND = {
                has_land = yes
                tag = VNT
                any_neighbour_country = {
                    tag = ROM
                }
                NOT = {
                    ROOT.country = {
                        has_variable = encountered_the_romans_vnt
                    }
                }
                has_completed_mission_task = secure_venetia_mission_task_6
            }
        }
    }

    immediate = {
        ROOT.country = {
            set_variable = {
                name = encountered_the_romans_vnt
            }
        }
        if = { 
            limit = {
                NOT = {
                    alliance_with = c:ROM
                }
            }
            scope:encountered_the_romans_vnt = {
                trigger_event = {
                    id = veneto_flavour_event.5
                }
            }
        }
    }
	
}

veneto_flavour_event.5 = { #arrival of the romans
    type = country_event
    title =	veneto_flavour_event.5.t
    desc = veneto_flavour_event.5.desc 
    picture = great_city

    immediate = {
        add_opinion = {
            modifier = in_awe_of_rome_ven
            target = c:ROM
        }
        ROOT = {
            trigger_event = {
                id = veneto_flavour_event.7
                days = { 180 730 }
            }
            save_scope_as = country_in_awe_of_rome_veneto
        }
    }

    option = {
        name = veneto_flavour_event.5.a #Let us send them a request for amicitia!
        custom_tooltip = veneto_flavour_event.5.a.tt
        c:ROM = {
            trigger_event = {
                id = veneto_flavour_event.6
            }
        }
        ai_chance = {
            factor = 80
        }
    }

    option = {
        name = veneto_flavour_event.5.b #We are perfectly fine fighting the Gauls on our own
    }
}

veneto_flavour_event.6 = { #The veneti request an alliance
    type = country_event
    title =	veneto_flavour_event.6.t
    desc = veneto_flavour_event.6.desc 
    picture = celtic_chiefs

    immediate = {
        add_opinion = {
            modifier = offered_expertise_against_the_gauls
            target = scope:country_in_awe_of_rome_veneto
        }
    }

    option = {
        name = veneto_flavour_event.6.a #We could do with an ally against the Gauls
        add_alliance = scope:country_in_awe_of_rome_veneto
        ai_chance = {
            factor = 65
        }
    }

    option = {
        name = veneto_flavour_event.6.b #Why ally the Veneti, when we can simply conquer them?
    }
}

veneto_flavour_event.7 = { #Treading on Eggshells
    type = country_event
    title =	veneto_flavour_event.7.t
    desc = veneto_flavour_event.7.desc 
    picture = council_country

    trigger = {
        root = {
            OR = {
                AND = {
                    alliance_with = c:ROM
                    c:ROM = {
                        num_of_cities >= 35
                    }
                }
                AND = {
                    alliance_with = c:ETR
                    c:ETR = {
                        num_of_cities >= 35
                    }
                }
            }
        }
        root = {
            country_population <= 600
        }
        NOT = {
            has_variable = pondered_diplo_stance_in_cisalpine_gaul_vnt
        }
        NOT = {
            diplomatic_stance = appeasement_stance
        }
    }

    immediate = {
        set_variable = {
            name = pondered_diplo_stance_in_cisalpine_gaul_vnt
        }
    }

    option = {
        name = veneto_flavour_event.7.a #We must change the way our neighbours see us
        add_country_modifier = {
            name = me_vnt_appeasing_diplomacy_cmod
            duration = 3650 #10 years
        }
        ai_chance = {
            factor = 90
        }
    }   

    option = {
        name = veneto_flavour_event.7.b #Our current approach is fine!
    }   
}

veneto_flavour_event.8 = { #spartan invasion
    type = country_event
    hidden = yes #form spartan raiding army

    trigger = {
        char:176 = {
            is_alive = yes
            is_ruler = no
        }
    }

    immediate = {
        c:BAR = {
            create_unit = {
                navy = no
                location = p:3594
                name = "Kleonymos' Army"
                commander = char:176
                while = {
                    count = 8
                    add_subunit = spearmen 
                }
                while = {
                    count = 10
                    add_subunit = light_infantry 
                }
                while = {
                    count = 2
                    add_subunit = supply_train 
                }
            }
        }
        scope:venetic_country_owner_of_patavium = {
            trigger_event = {
                id = veneto_flavour_event.9
            }
        }
    }
    
}

veneto_flavour_event.9 = { #A spartan army attacks Patavium!
    type = country_event
    title = veneto_flavour_event.9.t
    desc = veneto_flavour_event.9.desc 
    left_portrait = current_ruler
    right_portrait = char:176
    picture = greeks_marching

    option = {
        name = veneto_flavour_event.9.a
        #show_as_tooltip = {
            #text = veneto_flavour_event.9_tt #tooltip not working
            trigger_event = {
                id = veneto_flavour_event.11 
                days = 182 #0.5 years
            }
            trigger_event = {
                id = veneto_flavour_event.13
                days = 730 #2 years
            }
        #}
    }

}

veneto_flavour_event.10 = { #Form Veneto 
    type = country_event
    title = veneto_flavour_event.10.t
    desc = veneto_flavour_event.10.desc
    left_portrait = current_ruler
    picture = shrine_city

    immediate = {
        ROOT = {
            set_variable = venetic_country_that_formed_veneto
        }
        area:venetia_area = {
            add_provincial_claim_effect = yes
        }
        area:ferraria_area = {
            add_provincial_claim_effect = yes
        }
        change_country_name = "VNT"
        hidden_effect = {
            change_country_adjective = "VNT_ADJ"
            change_country_tag = VNT
            if = {
                limit = {
                    NOT = {
                        primary_culture = histrian
                    }
                }
                change_country_color = navy_blue
            }
            if = {
                limit = {
                    NOT = {
                        primary_culture = histrian
                    }
                }
                change_country_flag = VNT
             }
            if = {
                limit = {
                    primary_culture = histrian
                }
                change_country_flag = HISTRIAN_VNT
                random_country_culture = {
                    limit = {
                        is_culture = venetic
                    }
                    set_country_culture_right = nobles
                    add_integration_progress = 1
                }
            }
        }
    }

    option = {
        name = veneto_flavour_event.10.a
    }
    
}

veneto_flavour_event.11 = {
    type = country_event
    hidden = yes

    immediate = {
        if = {
            limit = {
                NOT = {
                    char:176 = {
                        OR = {
                            is_at_location = p:3594
                            is_at_location = p:145
                            is_at_location = p:3593
                            is_at_location = p:143
                            is_at_location = p:3597
                            is_at_location = p:3589
                            is_at_location = p:3590
                            is_at_location = p:3595
                            is_at_location = p:3596
                            is_at_location = p:3600
                            is_at_location = p:3599
                            is_at_location = p:3598
                            is_at_location = p:3603
                            is_at_location = p:3601
                            is_at_location = p:3602
                            is_at_location = p:3604
                            is_at_location = p:3605
                            is_at_location = p:3606
                            is_at_location = p:3607
                        }
                    }
                }
                p:3594 = {
                    controller = scope:venetic_country_owner_of_patavium
                }   
            }
            trigger_event = {
                id = veneto_flavour_event.12
            }
        }
        if = {
            limit = {
                char:176 = {
                    OR = {
                        is_at_location = p:3594
                        is_at_location = p:145
                        is_at_location = p:3593
                        is_at_location = p:143
                        is_at_location = p:3597
                        is_at_location = p:3589
                        is_at_location = p:3590
                        is_at_location = p:3595
                        is_at_location = p:3596
                        is_at_location = p:3600
                        is_at_location = p:3599
                        is_at_location = p:3598
                        is_at_location = p:3603
                        is_at_location = p:3601
                        is_at_location = p:3602
                        is_at_location = p:3604
                        is_at_location = p:3605
                        is_at_location = p:3606
                        is_at_location = p:3607
                    }
                }
                c:VNT = {
                    NOT = {
                        has_variable = cleonymos_victory_declared
                    }
                }   
                NOT = {
                    current_date > 500
                }           
            }
            scope:venetic_country_owner_of_patavium = {
                trigger_event = {
                    id = veneto_flavour_event.11
                    days = 182
                }
            }
        }
    }
}

veneto_flavour_event.12 = {
    type = country_event 
    title = veneto_flavour_event.12.t #The defeat of Kleonymos
    desc = veneto_flavour_event.12.desc 
    left_portrait = current_ruler
    picture = celtic_religious_festival
    
    immediate = {
        c:BAR = {
            every_army = {
                limit = {
                    commander = char:176
                }
                every_sub_unit = { 
                    destroy_subunit = yes
                }
                destroy_unit = yes
            }
            every_army = {
                limit = {
                    is_in_area = venetia_area
                }
                every_sub_unit = { 
                    destroy_subunit = yes
                }
                destroy_unit = yes
            }
            every_army = {
                limit = {
                    is_in_area = ferraria_area
                }
                every_sub_unit = { 
                    destroy_subunit = yes
                }
                destroy_unit = yes
            }
        } 
        char:176 = {
            move_country_with_close_family_effect = {
                COUNTRY = c:SPA
            }
        }
        scope:venetic_country_owner_of_patavium = {
            set_variable = {
                name = veneto_defeated_kleonymos
            }
        }
        if = {
            limit = {
                char:176 = {
                    is_alive = yes
                }
            }
            c:SPA = {
                trigger_event = {
                    id = veneto_flavour_event.18
                }
            }
        }
        if = {
            limit = {
                char:176 = {
                    is_alive = no
                }
            }
            c:SPA = {
                trigger_event = {
                    id = veneto_flavour_event.19
                }
            }
        }
    }

    option = {
        name = veneto_flavour_event.12.a
        add_stability = 10
        current_ruler = {
            add_popularity = 10
        }
    }
}

veneto_flavour_event.13 = { #check if Kleonymos controls patavium
    type = country_event
    hidden = yes

    immediate = {
        if = {
            limit = {
                p:3594 = {
                    controller = scope:venetic_country_owner_of_patavium
                }
            }
            scope:venetic_country_owner_of_patavium = {
                if = {
                    limit = {
                        NOT = {
                            scope:venetic_country_owner_of_patavium = {
                                has_variable = veneto_defeated_kleonymos
                            }
                        }
                    }
                    trigger_event = {
                        id = veneto_flavour_event.12
                    }
                }
            }
        }
        if = {
            limit = {
                AND = {
                    p:3594 = {
                        controller = c:BAR
                    }
                    char:176 = {
                        OR = {
                            is_at_location = p:3594
                            is_at_location = p:145
                            is_at_location = p:3593
                            is_at_location = p:143
                            is_at_location = p:3597
                            is_at_location = p:3589
                            is_at_location = p:3590
                            is_at_location = p:3595
                            is_at_location = p:3596
                            is_at_location = p:3600
                            is_at_location = p:3599
                            is_at_location = p:3598
                            is_at_location = p:3603
                            is_at_location = p:3601
                            is_at_location = p:3602
                            is_at_location = p:3604
                            is_at_location = p:3605
                            is_at_location = p:3606
                            is_at_location = p:3607
                        }
                    }
                }
            }
            scope:venetic_country_owner_of_patavium = { 
                trigger_event = {
                    id = veneto_flavour_event.14
                }
                set_variable = {
                    name = cleonymos_victory_declared
                }
            }
        }
    }
}

veneto_flavour_event.14 = {
    type = country_event
    title = veneto_flavour_event.14.t #Kleonymos' Victory
    desc = veneto_flavour_event.14.desc #
    right_portrait = char:176 
    picture = looting_dishonor

    immediate = {
        p:3594 = {
            random_pops_in_province = {
                kill_pop = yes
            }
            random_pops_in_province = {
                kill_pop = yes
            }
            random_pops_in_province = {
                kill_pop = yes
            }
            random_pops_in_province = {
                kill_pop = yes
            }
            set_controller = root
        }
        c:BAR = {
            every_army = {
                limit = {
                    commander = char:176
                }
                every_sub_unit = { 
                    destroy_subunit = yes
                }
                destroy_unit = yes
            }
            every_army = {
                limit = {
                    is_in_area = venetia_area
                }
                every_sub_unit = { 
                    destroy_subunit = yes
                }
                destroy_unit = yes
            }
            every_army = {
                limit = {
                    is_in_area = ferraria_area
                }
                every_sub_unit = { 
                    destroy_subunit = yes
                }
            } 
        }
    }

    option = {
        name = veneto_flavour_event.14.a #Let us give Kleonymus the wealth he wants
        add_treasury = -300
        char:176 = {
            add_gold = 300
            move_country_with_close_family_effect = {
                COUNTRY = c:SPA 
            }
        }
        scope:venetic_country_owner_of_patavium = {
            current_ruler = {
                add_popularity = -50
            }
        }
        c:SPA = {
            trigger_event = {
                id = veneto_flavour_event.20
            }
        }
        ai_chance = {
            factor = 75
        }
    }

    option = {
        name = veneto_flavour_event.14.b #[Patavium] is under Kleonymus' control now,
        custom_tooltip = veneto_flavour_event.14.b_tt
        hidden_effect = {
            p:3594 = {
                define_pop = {
                    type = nobles
                    culture = peloponnesian
                    religion = roman_pantheon
                }
                define_pop = {
                    type = nobles
                    culture = peloponnesian
                    religion = roman_pantheon
                }
                define_pop = {
                    type = nobles
                    culture = peloponnesian
                    religion = roman_pantheon
                }
                define_pop = {
                    type = nobles
                    culture = peloponnesian
                    religion = roman_pantheon
                }
                create_country = {
                    name = {
                        name = SPARTAN_PATAVIUM
                        adjective = SPARTAN_PATAVIUM_ADJ
                    }
                    change_country_color = light_yellow
                    set_country_heritage = spartan_heritage
                    change_government = despotic_monarchy
                    save_scope_as = spartan_patavium_country
                    add_treasury = 10
                    if = {
                        limit = {
                            NOT = {
                                primary_culture = peloponnesian
                            }
                        }
                        set_primary_culture_cleanup_effect = {
                            NEW_PRIMARY_CULTURE = peloponnesian
                            MAKE_OLD_CULTURE_INTEGRATED = yes
                        }
                    }
                    set_country_religion = roman_pantheon
                }
                change_province_name = PROV3594_hellenic
            }    
            char:176 = {
                move_country_with_close_family_effect = { 
                    COUNTRY = scope:spartan_patavium_country
                }
            }
            scope:spartan_patavium_country = {
                set_as_ruler = char:176
             }
            c:SPA = {
                make_subject = {
                    target = scope:spartan_patavium_country
                    type = subject_colony
                }
            }
        }
        scope:venetic_country_owner_of_patavium = {
            add_stability = -20
            current_ruler = {
                add_popularity = -60
            }
        }
        c:SPA = {
            trigger_event = {
                id = veneto_flavour_event.21
            }
        }
        ai_chance = {
            factor = 25
        }
    }
}

veneto_flavour_event.15 = { #Kleomynos seiges Apullia
    type = country_event 
    hidden = yes

    trigger = {
        char:176 = {
            is_alive = yes
            is_ruler = no
        }
    }

    immediate = {
        c:SPA = {
            trigger_event = {
                id = veneto_flavour_event.17
            }
            char:176 ={
                save_scope_as = ambitious_spartan_raiding_prince
            }
        }
        char:176 = {
            move_country_with_close_family_effect = { 
                COUNTRY = c:BAR 
            }  
        }
        random_country = {
            limit = {
                owns = p:66
            }
            trigger_event = {
               id = veneto_flavour_event.16
               days = { 10 20 }
            }
        }
        c:BAR = {
            create_unit = {
                navy = no
                location = p:66
                name = "Kleonymos' Army"
                commander = scope:ambitious_spartan_raiding_prince
                while = {
                    count = 8
                    add_subunit = spearmen 
                }
                while = {
                    count = 10
                    add_subunit = light_infantry 
                }
                while = {
                    count = 2
                    add_subunit = supply_train 
                }
            }
        }
    }
}

veneto_flavour_event.16 = { #Kleomynos retreats from Apulia
    type = country_event
    title = veneto_flavour_event.16.t
    desc = veneto_flavour_event.16.desc
    right_portrait = char:176
    picture = greeks_marching

    immediate = {
         every_country = {
            if = {
                limit = {
                    AND = {
                        primary_culture = venetic
                        owns_or_subject_owns = p:3594
                    }
                } 
                save_scope_as = venetic_country_owner_of_patavium
                trigger_event = {
                    id = veneto_flavour_event.8
                    days = { 30 65 }
                }
            }
        }
        c:BAR = {
            every_army = {
                limit = {
                    commander = char:176
                }
                every_sub_unit = { 
                    destroy_subunit = yes
                }
                destroy_unit = yes
            }
            every_army = {
                limit = {
                    is_in_area = tarentum_area
                }
                every_sub_unit = { 
                    destroy_subunit = yes
                }
                destroy_unit = yes
            }
            every_army = {
                limit = {
                    is_in_area = cannae_area
                }
                every_sub_unit = { 
                    destroy_subunit = yes
                }
            } 
        }
    }

    option = {
        name = veneto_flavour_event.16.a #crisis averted
    }
}

veneto_flavour_event.17 = { #Kleomynos heads off for Italy - 2nd expedition
    type = country_event
    title = veneto_flavour_event.17.t
    desc = veneto_flavour_event.17.desc
    right_portrait = char:176
    picture = grand_ship

    option = {
        name = veneto_flavour_event.17.a
    }
}

veneto_flavour_event.18 = { #Kleomynos is defeated
    type = country_event
    title = veneto_flavour_event.18.t
    desc = veneto_flavour_event.18.desc
    right_portrait = char:176
    picture = ship_in_storm

    immediate = {
        char:176 = {
            add_popularity = -40
            add_prominence = -50
        }
    }

    option = {
        name = veneto_flavour_event.18.a
    }
}

veneto_flavour_event.19 = { #Kleomynos dies on expedition
    type = country_event
    title = veneto_flavour_event.19.t
    desc = veneto_flavour_event.19.desc
    right_portrait = char:176
    picture = ship_in_storm

    option = {
        name = veneto_flavour_event.19.a
    }
}

veneto_flavour_event.20 = { #Kleomynos returns home in glory
    type = country_event
    title = veneto_flavour_event.20.t
    desc = veneto_flavour_event.20.desc
    right_portrait = char:176
    picture = diadochi_legion_carrying_standard

    immediate = {
        char:176 = {
            add_prominence = 50
            add_popularity = 40
        }
    }

    option = {
        name = veneto_flavour_event.20.a
    }
}

veneto_flavour_event.21 = { #Kleomynos establishes a spartan colony in patavium
    type = country_event
    title = veneto_flavour_event.21.t
    desc = veneto_flavour_event.21.desc
    right_portrait = char:176
    picture = city_siege_honor

    option = {
        name = veneto_flavour_event.21.a
    }
}