namespace = me_messapia

me_messapia.1 = {
    type = country_event

    title = me_messapia_1_title
    desc = me_messapia_1_desc
    picture = great_library

    option = {
        name = "me_messapia_1.a"
        custom_tooltip = me_messapia_1_tooltip

    }
}
me_messapia.2 = {
    type = country_event

    title = me_messapia_2_title
    desc = me_messapia_2_desc
    picture = great_library

    option = {
        name = "me_messapia_2.a"
        custom_tooltip = me_messapia_2_tooltip

    }
}
me_messapia.3 = {
    type = country_event

    title = me_messapia_3_title
    desc = me_messapia_3_desc
    picture = great_library

    option = {
        name = "me_messapia_3.a"
        custom_tooltip = me_messapia_3_tooltip

    }
}
me_messapia.4 = {
    type = country_event

    title = me_messapia_4_title
    desc = me_messapia_4_desc
    picture = great_library

    option = {
        name = "me_messapia_4.a"
        custom_tooltip = me_messapia_4_tooltip

    }
}
me_messapia.5 = {
    type = country_event

    title = me_messapia_5_title
    desc = me_messapia_5_desc
    picture = great_library

    option = {
        name = "me_messapia_5.a"
        custom_tooltip = me_messapia_5_tooltip

    }
}
me_messapia.6 = {
    type = country_event

    title = me_messapia_6_title
    desc = me_messapia_6_desc
    picture = great_library

    option = {
        name = "me_messapia_6.a"
        custom_tooltip = me_messapia_6_tooltip

    }
}
me_messapia.7 = {
    type = country_event

    title = me_messapia_7_title
    desc = me_messapia_7_desc
    picture = great_library

    option = {
        name = "me_messapia_7.a"
        custom_tooltip = me_messapia_7_tooltip

    }
}
me_messapia.8 = {
    type = country_event

    title = me_messapia_8_title
    desc = me_messapia_8_desc
    picture = great_library

    option = {
        name = "me_messapia_8.a"
        custom_tooltip = me_messapia_8_tooltip

    }
}
me_messapia.9 = {
    type = country_event

    title = me_messapia_9_title
    desc = me_messapia_9_desc
    picture = great_library

    option = {
        name = "me_messapia_9.a"
        custom_tooltip = me_messapia_9_tooltip

    }
}
me_messapia.10 = {
    type = country_event

    title = me_messapia_10_title
    desc = me_messapia_10_desc
    picture = great_library

    option = {
        name = "me_messapia_10.a"
        custom_tooltip = me_messapia_10_tooltip

    }
}
me_messapia.11 = {
    type = country_event

    title = me_messapia_11_title
    desc = me_messapia_11_desc
    picture = great_library

    option = {
        name = "me_messapia_11.a"
        custom_tooltip = me_messapia_11_tooltip

    }
}
me_messapia.12 = {
    type = country_event

    title = me_messapia_12_title
    desc = me_messapia_12_desc
    picture = great_library

    option = {
        name = "me_messapia_12.a"
        custom_tooltip = me_messapia_12_tooltip

    }
}
me_messapia.13 = {
    type = country_event

    title = me_messapia_13_title
    desc = me_messapia_13_desc
    picture = great_library

    option = {
        name = "me_messapia_13.a"
        custom_tooltip = me_messapia_13_tooltip

    }
}
me_messapia.14 = {
    type = country_event

    title = me_messapia_14_title
    desc = me_messapia_14_desc
    picture = great_library

    option = {
        name = "me_messapia_14.a"
        custom_tooltip = me_messapia_14_tooltip

    }
}
me_messapia.15 = {
    type = country_event

    title = me_messapia_15_title
    desc = me_messapia_15_desc
    picture = great_library

    option = {
        name = "me_messapia_15.a"
        custom_tooltip = me_messapia_15_tooltip

    }
}
me_messapia.16 = {
    type = country_event

    title = me_messapia_16_title
    desc = me_messapia_16_desc
    picture = great_library

    option = {
        name = "me_messapia_16.a"
        custom_tooltip = me_messapia_16_tooltip

    }
}
me_messapia.17 = {
    type = country_event

    title = me_messapia_17_title
    desc = me_messapia_17_desc
    picture = great_library

    option = {
        name = "me_messapia_17.a"
        custom_tooltip = me_messapia_17_tooltip

    }
}
me_messapia.18 = {
    type = country_event

    title = me_messapia_18_title
    desc = me_messapia_18_desc
    picture = great_library

    option = {
        name = "me_messapia_18.a"
        custom_tooltip = me_messapia_18_tooltip

    }
}
me_messapia.19 = {
    type = country_event

    title = me_messapia_19_title
    desc = me_messapia_19_desc
    picture = great_library

    option = {
        name = "me_messapia_19.a"
        custom_tooltip = me_messapia_19_tooltip

    }
}
me_messapia.20 = {
    type = country_event

    title = me_messapia_20_title
    desc = me_messapia_20_desc
    picture = great_library

    option = {
        name = "me_messapia_20.a"
        custom_tooltip = me_messapia_20_tooltip

    }
}
me_messapia.21 = {
    type = country_event

    title = me_messapia_21_title
    desc = me_messapia_21_desc
    picture = great_library

    option = {
        name = "me_messapia_21.a"
        custom_tooltip = me_messapia_21_tooltip

    }
}
me_messapia.22 = {
    type = country_event

    title = me_messapia_22_title
    desc = me_messapia_22_desc
    picture = great_library

    option = {
        name = "me_messapia_22.a"
        custom_tooltip = me_messapia_22_tooltip

    }
}
me_messapia.23 = {
    type = country_event

    title = me_messapia_23_title
    desc = me_messapia_23_desc
    picture = great_library

    option = {
        name = "me_messapia_23.a"
        custom_tooltip = me_messapia_23_tooltip

    }
}
me_messapia.24 = {
    type = country_event

    title = me_messapia_24_title
    desc = me_messapia_24_desc
    picture = great_library

    option = {
        name = "me_messapia_24.a"
        custom_tooltip = me_messapia_24_tooltip

    }
}
me_messapia.25 = {
    type = country_event

    title = me_messapia_25_title
    desc = me_messapia_25_desc
    picture = great_library

    option = {
        name = "me_messapia_25.a"
        custom_tooltip = me_messapia_25_tooltip

    }
}

### Start of the war of 303 event chain

me_messapia.100 = { # triggers for Lucania, hidden
    type = country_event
    hidden = yes

    trigger = {
        tag = LCA
    }

    immediate = {
        c:LCA = {
            add_to_list = war_303_list
        }
        c:TAR = {
            add_to_list = war_303_list
            trigger_event = {
                id = me_messapia.102
                days = 121 # call Sparta ; 3 weeks after start of the war
            }
        }
        c:MSP = {
            trigger_event = {
                id = me_messapia.101
                days = 100 # from start
            }
        }
        c:APU = {
            trigger_event = {
                id = me_messapia.101
                days = 100 # from start
            }
        }
        c:SAM = {
            trigger_event = {
                id = me_messapia.101
                days = 100 # from start
            }
        }
    }
}

me_messapia.101 = {
    type = country_event
    title = me_messapia_101_title
    desc = me_messapia_101_desc
    left_portrait = c:MSP.current_ruler
    left_portrait = c:TAR.current_ruler
    left_portrait = c:APU.current_ruler

    right_portrait = c:LCA.current_ruler
    right_portrait = c:SAM.current_ruler

    picture = greeks_marching

    option = { # fight
        name = "me_messapia_101.a"
        custom_tooltip = war_303_tt_1
        add_war_exhaustion = 5
        add_to_list = war_303_list
    }

    option = { # surrender
        name = "me_messapia_101.b"
        custom_tooltip = war_303_tt_2
        add_political_influence = -50
        add_aggressive_expansion = 5
    }
}

me_messapia.102 = {
    type = country_event
    title = me_messapia_102_title
    desc = me_messapia_102_desc
    left_portrait = c:TAR.current_ruler
    left_portrait = c:SPA.current_ruler
    left_portrait = char:176 # Kleonymos

    right_portrait = c:LCA.current_ruler
    right_portrait = c:SAM.current_ruler

    picture = greeks_marching

    option = { # call sparta
        name = "me_messapia_102.a"
        custom_tooltip = war_303_tt_3
        c:SPA = {
            trigger_event = {
                id = me_messapia.103
                days = 8
            }
        }
    }

    option = { # Do not call sparta
        name = "me_messapia_102.b"
    }
}

me_messapia.103 = { # Ping Sparta
    type = country_event
    title = me_messapia_103_title
    desc = me_messapia_103_desc
    left_portrait = c:TAR.current_ruler
    left_portrait = c:SPA.current_ruler
    left_portrait = char:176 # Kleonymos

    right_portrait = c:LCA.current_ruler
    right_portrait = c:SAM.current_ruler

    picture = greeks_marching

    option = { # help tarentum - send kleonymos
        name = "me_messapia_103.a"
        add_treasury = 250
        add_manpower = -4
        every_in_list = {
            list = war_303_list
            trigger_event = {
                id = me_messapia.104 # Sparta joins war
                days = 8
            }
        }
        
        ai_chance = {
            add = 100
        }
    }

    option = { # do not help
        name = "me_messapia_103.b"
        c:TAR = {
            add_opinion = {
                modifier = refused_help_spa_tar
                target = ROOT
            }
            ### SPARTA REFUSES TO JOIN - MORE EVENTS TO SIMULATE WAR. OUTCOME SKEWED IN LUCANIA/SAMNIUM FAVOUR
        }
    }
}

me_messapia.104 = { # sparta joined
    type = country_event
    title = me_messapia_104_title
    desc = me_messapia_104_desc
    left_portrait = c:TAR.current_ruler
    left_portrait = c:SPA.current_ruler
    left_portrait = char:176 # Kleonymos

    right_portrait = c:LCA.current_ruler
    right_portrait = c:SAM.current_ruler

    picture = greeks_marching

    option = { #"great"
        name = "me_messapia_104.a"
        trigger = {
            OR = {
                tag = TAR
                tag = MSP
                tag = APU
            }
        }
        if = {
            limit = {
                tag = TAR
            }
            add_treasury = -250
            add_manpower = 4
        }
        add_war_exhaustion = -5
    }

    option = { 
        name = "me_messapia_104.b"
        trigger = {
            OR = {
                tag = SAM
                tag = LCA
            }
        }
        add_war_exhaustion = 5
    }

    option = { # give up
        name = "me_messapia_104.c"
        trigger = {
            OR = {
                tag = SAM
                tag = LCA
            }
        }
        if = {
            limit = {
                tag = SAM
            }
            set_global_variable = war_303_samnium_out
            trigger_event = {
                id = me_messapia.106
                days = 8
            }
        }
        else_if = { # War Leader - if give up, war ends
            limit = {
                tag = LCA
            }
            set_global_variable = war_303_end
            trigger_event = {
                id = me_messapia.107
                days = 8
            }
        }

        ai_chance = { # if samnium is a player to not fuck the player over
            modifier = {
                add = -100
                c:SAM = {
                    is_ai = no
                }
            }
            modifier = {
                add = 25
                c:MSP = { # id there's a player on Messapia, it should be more likely that the player wins.
                    is_ai = no
                }
            }
        }
    }
}

me_messapia.105 = { # Samnium Surrenders, Lucania does not
    type = country_event
    title = me_messapia_105_title
    desc = me_messapia_105_desc
    left_portrait = c:MSP.current_ruler
    left_portrait = c:TAR.current_ruler
    left_portrait = c:APU.current_ruler

    right_portrait = c:LCA.current_ruler
    right_portrait = c:SAM.current_ruler

    picture = greeks_marching

    trigger = {
        NOT = {
            has_global_variable = war_303_end
        }
    }

    immediate = {
        show_as_tooltip = {
            # HAS HAPPENED PEACE DEAL
            samnium_separate_peace_effect = yes
        }
    }

    option = { # great, samnium is out
        name = "me_messapia_105.a"
        trigger = {
            NOT = { tag = LCA }
        }
    }

    option = { # ally abandoned us
        name = "me_messapia_105.b"
        trigger = {
            tag = LCA
        }
        reverse_add_opinion = {
            modifier = refused_help_spa_tar # loced neutrally
            target = c:SAM
        }
        trigger_event = {
            id = me_messapia_109 # give up now that samnium left?
            days = 8
        }
    }
}

me_messapia.106 = { # Samnium peace deal, without lucania
    type = country_event
    hidden = yes

    trigger = {
        NOT = {
            has_global_variable = war_303_end
        }
    }

    immediate = {
        #SAMNIUM SCRIPTED PEACE DEAL
        samnium_separate_peace_effect = yes
        c:SAM = {
            remove_from_list = war_303_list
        }
        every_in_list = {
            list = war_303_list
            trigger_event = {
                id = me_messapia.105 # notif about samnium peace out
            }
        }
        remove_global_variable = war_303_samnium_out 
    }
}

me_messapia.107 = { # End of War if Lucania surrenders
    type = country_event
    hidden = yes

    trigger = {
        has_global_variable = war_303_end
    }

    immediate = {
        #LUCANIA SCRIPTED PEACE DEAL - Will end war
        lucania_surrenders_peace_effect = yes
        c:LCA = {
            remove_from_list = war_303_list
        }
        if = {
            limit = {
                has_global_variable = war_303_samnium_out
            }
            c:SAM = {
                remove_from_list = war_303_list
            }
            remove_global_variable = war_303_samnium_out # no longer needed after that
        }
        every_in_list = {
            list = war_303_list
            trigger_event = {
                id = me_messapia.108 # notif about samnium peace out
            }
        }
        remove_global_variable = war_303_end
    }
}

me_messapia.108 = { # End of War Ping to others
    type = country_event
    title = me_messapia_108_title
    desc = me_messapia_108_desc
    left_portrait = c:MSP.current_ruler
    left_portrait = c:TAR.current_ruler
    left_portrait = c:APU.current_ruler

    right_portrait = c:LCA.current_ruler
    right_portrait = c:SAM.current_ruler

    picture = greeks_marching

    trigger = {
        has_global_variable = war_303_end
    }

    immediate = {
        show_as_tooltip = {
            # HAS HAPPENED PEACE DEAL
            lucania_surrenders_peace_effect = yes
        }
    }

    option = { # war won, great!
        name = "me_messapia_108.a"
        trigger = {
            NOT = { tag = SAM }
        }
    }

    option = { # ally surrendered even with our help, darn
        name = "me_messapia_108.b"
        trigger = {
            tag = SAM
        }
    }
}

me_messapia.109 = { # for Lucania, if Samnium gave up: surrender as well, or continue fighting?
    type = country_event
    title = me_messapia_109_title
    desc = me_messapia_109_desc
    left_portrait = c:MSP.current_ruler
    left_portrait = c:TAR.current_ruler
    left_portrait = c:APU.current_ruler

    right_portrait = c:LCA.current_ruler
    right_portrait = c:SAM.current_ruler

    picture = greeks_marching

    trigger = {
        has_global_variable = war_303_samnium_out
    }

    immediate = {
        custom_tooltip = war_303_samnoum_out_tt
    }

    option = { # surreneder as well
        name = "me_messapia_109.a"
        set_global_variable = war_303_end
        trigger_event = {
            id = me_messapia.107
            days = 8
        }
    }

    option = { # continue fighting alone
        name = "me_messapia_109.b"
        # MORE EVENTS TO SIMULATE WAR. OUTCOME SKEWED IN TARENTUM ET AL'S FAVOUR
    }
}