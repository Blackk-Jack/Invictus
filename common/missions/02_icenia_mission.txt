icenia_mission_tree = {
    header = "mssion_gaul"
    icon = rome_3

    repeatable = no
	
    chance = {
        factor = 5
    }

    potential = {
        NOT = { has_variable = mission_cooldown_var }
        tag = ICE
    }

    abort = {
		ai_mission_back_out_trigger = yes
	}
	
    on_start = {
        start_mission_ai_effect = yes
		trigger_event = me_icenia.1
    }
	
    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = mission_cooldown_var
            days = 7300
        }
    }
	
    on_completion = {
		capital_scope = {
            capital_formable_small_effect = yes
        }
        complete_mission_effect = yes
    }
	
    icenia_mission_tree_task_1 = { #Friends At Our Back
        icon = "task_political"

        allow = {
			custom_tooltip = {
				text = icenia_mission_tree_task_1_tt
				any_country = {
					country_culture_group = britannic
					NOT = { this = root }
					is_subject = no
					alliance_with = root
				}
			}
            war = yes
        }
		

        on_completion = {
            trigger_event = me_icenia.6
            add_country_modifier = {
				name = "icenian_allies_mod"
				duration = 1835
			}
        }
        
    }
	
    icenia_mission_tree_task_2 = { #
        icon = "task_battle"
		requires = { icenia_mission_tree_task_1 }
		duration = 90
		
		highlight = {
            scope:province = {
                province_id = 440
            }
        }
		
        allow = {
        }
		
        on_completion = {
        }
    }
	
    icenia_mission_tree_task_3 = { #The Battle For Icenia
        icon = "task_battle"
        duration = 90
		
        highlight = {
			scope:province = {
				is_in_area = icenia_area
			}
		}

        allow = {
            custom_tooltip = {
                text = icenia_send_insult_tt
                hidden:c:TRI = {
                    has_opinion = {
                        modifier = opinion_insult
                        target = ROOT
                    }
                }
            } 
        }

        bypass = {
			c:TRI = { has_land = no }
		}
		
        on_completion = {
            trigger_event = me_icenia.3
            area:icenia_area = {
				add_provincial_claim_effect = yes
			}
        }
        
    }
	
    icenia_mission_tree_task_4 = { #
        icon = "task_economical"
		duration = 730
        requires = { icenia_mission_tree_task_1 icenia_mission_tree_task_3 }
		
		highlight = {
            scope:province = {
                province_id = 440
            }
        }
		
        allow = {
        }
		
        on_completion = {
            trigger_event = me_icenia.7
        }
    }
	
    icenia_mission_tree_task_5 = { #
        icon = "task_diplomatic"
        requires = { icenia_mission_tree_task_4 }
        duration = 730
		
        allow = {
            political_influence >= 40
        }
		
        on_completion = {
            trigger_event = me_icenia.8
        }
    }
	
    icenia_mission_tree_task_6 = { #
        icon = "task_expansion"
        requires = { icenia_mission_tree_task_5 }

        highlight = {
            scope:province = {
                province_id = 440
            }
        }
		
        allow = {
			num_of_ships >= 40
        }
		
        on_completion = {
            trigger_event = me_icenia.9
        }
    }
	
    icenia_mission_tree_task_7 = { # 
        icon = "task_calm"
        requires = { icenia_mission_tree_task_5 }
		
        allow = {

        }
		
		
        on_completion = {
            trigger_event = me_icenia.10
        }
    }
	
    icenia_mission_tree_task_8 = { #
        requires = { icenia_mission_tree_task_6 icenia_mission_tree_task_7 }
        icon = "task_apollo"
		final = yes
		
        allow = {
            }
		
        on_completion = {
            trigger_event = me_icenia.11
        }
    }
	
    icenia_mission_tree_task_9 = { #Trade and Administration
        icon = "task_economical"

		highlight = {
			scope:province = {
				has_owner = yes
				owner = ROOT
				is_capital = yes
			}
		}
		
        allow = {
            capital_scope = {
                num_of_commerce_building >= 1
            }
            hidden:p:2032.state = {
                calc_true_if = {
                    amount >= 1
                    state_improvement_military_trigger = yes
                    state_improvement_civic_trigger = yes
                    state_improvement_oratory_trigger = yes
                    state_improvement_religious_trigger = yes
                }
            }
        }
		
        on_completion = {
            trigger_event = me_icenia.12
            add_centralization = 10
            add_country_modifier = {
                name = icenia_center_of_trade_mod
                duration = 3650
            }
        }
    }
	
    icenia_mission_tree_task_10 = { #
        icon = "task_conquest"
		requires = { icenia_mission_tree_task_9 }
		duration = 1825

		
        allow = {
        }
		
        on_completion = {
            trigger_event = me_icenia.13
        }
    }
	
    icenia_mission_tree_task_11 = { # A Reputation For Metalworking
        icon = "task_happiness"
        requires = { icenia_mission_tree_task_3 icenia_mission_tree_task_9 }
 
		highlight = {
			scope:province = {
				has_owner = yes
				owner = ROOT
				is_capital = yes
			}
		}
		
        allow = {
            capital_scope = {
                is_importing_trade_good = base_metals
                is_importing_trade_good = iron
                num_of_workshop_building >= 1
            }
        }
		
        on_completion = {
            trigger_event = me_icenia.14
            add_country_modifier = {
                name = icenian_metalworking_master_mod
                duration = -1
            }
        }
    }
	
    icenia_mission_tree_task_12 = { #
        icon = "task_calm"
		duration = 730

        requires = { icenia_mission_tree_task_10 }
		
		highlight = {
			scope:province = {
				province_id = 440
			}
		}
		
        allow = {
        }
		
        on_completion = {
            trigger_event = me_icenia.15
        }
    }
	
	icenia_mission_tree_task_13 = { #
        icon = "task_atlas"
		duration = 730
        requires = { icenia_mission_tree_task_5 icenia_mission_tree_task_12 }
		
        allow = {
			
        }
		
        on_completion = {
			trigger_event = me_icenia.16
        }
    }
	
	icenia_mission_tree_task_14 = { #
        icon = "task_artemis"
        requires = { icenia_mission_tree_task_4 }
		
        allow = {
        }
		
        on_completion = {
            trigger_event = me_icenia.18
        }
    }

    icenia_mission_tree_task_15 = { #
    requires = { icenia_mission_tree_task_12 }
    icon = "task_religion"

    highlight = {
        scope:province = {
            province_id = 440
        }
    }
    
    allow = {
    }

    on_completion = {
        trigger_event = me_icenia.19
    }
    }
}
