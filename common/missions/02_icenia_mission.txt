icenia_mission_tree = {
    header = "mssion_gaul"
    icon = rome_3

    repeatable = no
	
    chance = {
        factor = 5
    }

    potential = {
        NOT = { has_variable = mission_cooldown_var }
        tag = ICE
    }

    abort = {
		ai_mission_back_out_trigger = yes
	}
	
    on_start = {
        start_mission_ai_effect = yes
		trigger_event = me_icenia.1
    }
	
    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = mission_cooldown_var
            days = 7300
        }
    }
	
    on_completion = {
		capital_scope = {
            capital_formable_small_effect = yes
        }
        complete_mission_effect = yes
    }
	
    icenia_mission_tree_task_1 = { #Friends At Our Back
        icon = "task_political"

        allow = {
			custom_tooltip = {
				text = icenia_mission_tree_task_1_tt
				any_country = {
					country_culture_group = britannic
					NOT = { this = root }
					is_subject = no
					alliance_with = root
				}
			}
            war = yes
        }
		

        on_completion = {
            trigger_event = me_icenia.6
            add_country_modifier = {
				name = "icenian_allies_mod"
				duration = 1835
			}
        }
        
    }
	
    icenia_mission_tree_task_2 = { #
        icon = "task_battle"
		requires = { icenia_mission_tree_task_1 }
		duration = 90
		
		highlight = {
            scope:province = {
                province_id = 440
            }
        }
		
        allow = {
            custom_tooltip = {
                text = we_need_chariot_culture_tt
                has_military_bonus =  celtic_philosophy_start_bonus
            }
        }
		
        on_completion = {
            create_unit = {
                navy = no
                location = capital_scope
                hidden_effect = {
                add_subunit = chariots
                add_subunit = chariots                                              
                add_subunit = chariots   
                add_subunit = chariots   
                add_subunit = chariots   
                add_subunit = chariots   
                add_subunit = chariots   
                add_food = 100
                add_morale = 2
                }
            }
        }
    }
	
    icenia_mission_tree_task_3 = { #Our True Intentions
        icon = "task_battle"
        duration = 90
		
        highlight = {
			scope:province = {
				is_in_area = icenia_area
			}
		}

        allow = {
            custom_tooltip = {
                text = icenia_send_insult_tt
                hidden:c:TRI = {
                    has_opinion = {
                        modifier = opinion_insult
                        target = ROOT
                    }
                }
            } 
        }

        bypass = {
			c:TRI = { has_land = no }
		}
		
        on_completion = {
            trigger_event = me_icenia.3
            area:icenia_area = {
				add_provincial_claim_effect = yes
			}
        }
        
    }
	
    icenia_mission_tree_task_4 = { #Bartering With The Belgae
        icon = "task_economical"
		duration = 180
        requires = { icenia_mission_tree_task_1 icenia_mission_tree_task_3 }
		
		highlight = {
            scope:province = {
				OR = {
					AND = {
						exists = p:3843.owner
						owner = p:3843.owner
					}
                    province_id = 2032
				}
			}
        }
		
        allow = {
            num_of_ships >= 10
			OR = {
				hidden:p:3843.owner = {
					opinion = {
						target = root
						value >= 90
					}
				}
			}
			capital_scope = {
				num_of_forum_building >= 1
			}
        }
		
        on_completion = {
            trigger_event = me_icenia.7
            add_country_modifier = {
                name = icenian_belgae_trading_partners
                duration = -1
            }
        }
    }
	
    icenia_mission_tree_task_5 = { #The Battle For The South
        icon = "task_battle"
        requires = { icenia_mission_tree_task_4 }
        duration = 730

        highlight = {
            scope:province = {
                OR = {
                    is_in_area = cantiacia_area
                    is_in_area = dobunnia_area
                    is_in_area = coritania_area
                }
            }
        }
		
        allow = {
            political_influence >= 50
        }
		
        on_completion = {
            add_political_influence = -50
            area:dobunnia_area = {
                add_provincial_claim_effect = yes
			}
            area:cantiacia_area = {
                add_provincial_claim_effect = yes
			}
            area:coritania_area = {
                add_provincial_claim_effect = yes
			}
            trigger_event = me_icenia.8
            add_country_modifier = {
                name = the_battle_for_the_south_mod
                duration = 3650
            }
        }
    }
	
    icenia_mission_tree_task_6 = { #Pushing Westward
        icon = "task_expansion"
        requires = { icenia_mission_tree_task_5 }
        duration = 1095

        highlight = {
            scope:province = {
                is_in_area = dobunnia_area
            }
        }
		
        allow = {
			owns_or_subject_owns_area = dobunnia_area
        }
		
        on_completion = {
            area:durotrigia_area = {
                add_provincial_claim_effect = yes
			}
            area:britannia_secunda_meridionalis_area = {
                add_provincial_claim_effect = yes
			}
            area:britannia_secunda_septentrionalis_area = {
                add_provincial_claim_effect = yes
			}
            area:dumnonia_area = {
                add_provincial_claim_effect = yes
			}
            trigger_event = me_icenia.9
        }
    }
	
    icenia_mission_tree_task_7 = { # Icenian Horse Farms
        icon = "task_calm"
        requires = { icenia_mission_tree_task_5 }

        highlight = {
            scope:province = {
                OR = {
                    is_in_area = dobunnia_area
                    is_in_area = coritania_area
                }
            }
        }
		
        allow = {
            has_law = coin_minting_law
            custom_tooltip = {
                text = icenia_mission_tree_task_7_tt
                any_owned_province = {
                   count >= 3
                   OR = {
                    is_in_area = dobunnia_area
                    is_in_area = coritania_area
                   }
                   trade_goods = horses 
                   has_building = latifundia_building
               }
           }
        }
		
        on_completion = {
            area:brigantia_area = {
                add_provincial_claim_effect = yes
			}
            add_country_modifier = {
                name = icenian_horse_trainers_mod
                duration = -1
            }
            trigger_event = me_icenia.10
        }
    }
	
    icenia_mission_tree_task_8 = { #
        requires = { icenia_mission_tree_task_6 icenia_mission_tree_task_7 icenia_mission_tree_task_13 }
        icon = "task_heracles"
		final = yes
		
        allow = {
            custom_tooltip = {
                text = you_need_to_form_pritania_tt
                tag = BRA
            }
            }
		
        on_completion = {
            trigger_event = me_icenia.11
            add_country_modifier = {
                name = cenimagni_end_mod
                duration = -1
            }
        }
    }
	
    icenia_mission_tree_task_9 = { #Trade and Administration
        icon = "task_economical"

		highlight = {
			scope:province = {
				has_owner = yes
				owner = ROOT
				is_capital = yes
			}
		}
		
        allow = {
            capital_scope = {
                num_of_commerce_building >= 1
            }
            hidden:p:2032.state = {
                calc_true_if = {
                    amount >= 1
                    state_improvement_military_trigger = yes
                    state_improvement_civic_trigger = yes
                    state_improvement_oratory_trigger = yes
                    state_improvement_religious_trigger = yes
                }
            }
        }
		
        on_completion = {
            trigger_event = me_icenia.12
            add_centralization = 10
            add_country_modifier = {
                name = icenia_center_of_trade_mod
                duration = 3650
            }
        }
    }
	
    icenia_mission_tree_task_10 = { # Embracing La Tène Motifs
        icon = "task_happiness"
		requires = { icenia_mission_tree_task_9 }

        highlight = {
			scope:province = {
				has_owner = yes
				owner = ROOT
				is_capital = yes
			}
		}
		
        allow = {
            capital_scope = {
                num_of_library_building >= 1 
            }
            invention = military_tech_investment_inv_1
        }
		
        on_completion = {
            trigger_event = me_icenia.13
            p:2032 = {
        		add_province_modifier = {
        			name = icenian_la_tene_workshops_mod
        			duration = -1
        		}
        	}
        }
    }
	
    icenia_mission_tree_task_11 = { # A Reputation For Metalworking
        icon = "task_diplomatic"
        requires = { icenia_mission_tree_task_3 icenia_mission_tree_task_9 }
 
		highlight = {
			scope:province = {
				has_owner = yes
				owner = ROOT
				is_capital = yes
			}
		}
		
        allow = {
            capital_scope = {
                is_importing_trade_good = base_metals
                is_importing_trade_good = iron
                num_of_workshop_building >= 1
            }
        }
		
        on_completion = {
            trigger_event = me_icenia.14
            add_country_modifier = {
                name = icenian_metalworking_master_mod
                duration = -1
            }
        }
    }
	
    icenia_mission_tree_task_12 = { #A Wooden Road
        icon = "task_calm"
		duration = 730

        requires = { icenia_mission_tree_task_10 }
		
		highlight = {
			scope:province = {
				OR = {
					province_id = 2031
					province_id = 2032
					province_id = 2036
                    province_id = 2029
				}
			}
		}
		
        allow = {
            owns = 2031
            owns = 2032
            owns = 2036
            hidden:capital_scope.state = {
                trade_good_surplus = { target = wood value >= 2 }
            }
            invention = capital_trade_inv_2
            treasury >= 50
        }
		
        on_completion = {
            add_treasury = -50
            trigger_event = me_icenia.15
            p:2031 = {
				add_road_towards = 2032
			}
            p:2032 = {
				add_road_towards = 2036
			}
            p:2036 = {
				add_road_towards = 2029
			}
        }
    }
	
	icenia_mission_tree_task_13 = { #A Firm Grip
        icon = "task_atlas"
        requires = { icenia_mission_tree_task_5 icenia_mission_tree_task_12 }

        highlight = {
            scope:province = {
                OR = {
                    is_in_area = cantiacia_area
                    is_in_area = dobunnia_area
                    is_in_area = coritania_area
                }
            }
        }
		
        allow = {
            owns_percent_of_area = {
                PROVINCE = "p:2028"
                PERCENT = "0.75"
            }
            owns_percent_of_area = {
                PROVINCE = "p:2039"
                PERCENT = "0.75"
            }
            owns_percent_of_area = {
                PROVINCE = "p:2063"
                PERCENT = "0.75"
            }
        }
		
        on_completion = {
            add_2_free_province_investments = yes
            p:2028.state = {
                add_state_modifier = {
                    name = icenia_a_firm_grip_mod
                    duration = -1
                }
            }
            p:2039.state = {
                add_state_modifier = {
                    name = icenia_a_firm_grip_mod
                    duration = -1
                }
            }
            p:2063.state = {
                add_state_modifier = {
                    name = icenia_a_firm_grip_mod
                    duration = -1
                }
            }
			trigger_event = me_icenia.16
        }
    }
	
	icenia_mission_tree_task_14 = { #Iron In The Marshes
        icon = "task_artemis"
        requires = { icenia_mission_tree_task_4 }

        highlight = {
			scope:province = {
				province_id = 2052
			}
		}
		
        allow = {
            hidden:p:2052 = {
				has_building = slave_mine_building
			}
            hidden:p:2052 = {
				total_population >= 10
			}
        }
		
        on_completion = {
            trigger_event = me_icenia.18
            p:2052 = {
                add_province_modifier = {
                    name = iron_mines_of_durovigutum_mod
                    duration = -1
                }
            }
        }
    }

    icenia_mission_tree_task_15 = { #
    requires = { icenia_mission_tree_task_6 }
    icon = "task_religion"

    highlight = {
        scope:province = {
            OR = {
                is_in_area = durotrigia_area
                is_in_area = britannia_secunda_meridionalis_area
                is_in_area = britannia_secunda_septentrionalis_area
                is_in_area = dumnonia_area
            }
        }
    }
    
    allow = {
        owns_percent_of_area = {
            PROVINCE = "p:2012"
            PERCENT = "0.75"
        }
        owns_percent_of_area = {
            PROVINCE = "p:2010"
            PERCENT = "0.75"
        }
        owns_percent_of_area = {
            PROVINCE = "p:2092"
            PERCENT = "0.75"
        }
        owns_percent_of_area = {
            PROVINCE = "p:2106"
            PERCENT = "0.75"
        }
    }

    on_completion = {
        add_treasury = {
            add = root.has_monthly_income
            multiply = 24
        }
        trigger_event = me_icenia.19
        add_innovation = 1
            p:2012.state = {
                add_state_modifier = {
                    name = icenia_a_firm_grip_mod
                    duration = -1
                }
            }
            p:2010.state = {
                add_state_modifier = {
                    name = icenia_a_firm_grip_mod
                    duration = -1
                }
            }
            p:2092.state = {
                add_state_modifier = {
                    name = icenia_a_firm_grip_mod
                    duration = -1
                }
            }
            p:2106.state = {
                add_state_modifier = {
                    name = icenia_a_firm_grip_mod
                    duration = -1
                }
            }
    }
    }
}
