meshwesh_missions = {
    header = "mission_image_egypt"
    icon = "egypt_2"

    repeatable = no
    chance = 1000

    potential = {
        NOT = { has_variable = mission_cooldown_var }
        has_variable = terror_of_desert_path
    }

    abort = {}
    on_start = {
        start_mission_ai_effect = yes
    }
    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = mission_cooldown_var
            days = 7300
        }
    }
    on_completion = {}
    meshwesh_missions_task_1 = { # The Lands of the Nile
        icon = "task_happiness"
        duration = 180
        highlight = {
            scope:province = {
                OR = {
                    is_in_area = marmarica_occidentalis_area
                    is_in_area = ammon_area
                    is_in_area = marmarica_orientalis_area
                }
            }
        }
        allow = {
            war = no
            stability >= 45
            has_country_modifier = assemble_raiding_party_button_modifier
        }
        on_completion = {
            trigger_event = me_meshwesh.1
            show_as_tooltip = {
                area:marmarica_occidentalis_area = {
                    every_area_province = {
                        add_claim = root
                    }
                }
                area:ammon_area = {
                    every_area_province = {
                        add_claim = root
                    }
                }
                area:marmarica_orientalis_area = {
                    every_area_province = {
                        add_claim = root
                    }
                }
            }
        }
    }
    meshwesh_missions_task_2 = { # Mass Migrations
        icon = "task_diplomatic"
        requires = { meshwesh_missions_task_1 }
        highlight = {
            scope:province = {
                OR = {
                    province_id = 6499
                    province_id = 5350
                    province_id = 6498
                    province_id = 5995
                    province_id = 5994
                    province_id = 5339
                    province_id = 5340
                }
            }
        }
        allow = {
            treasury >= 100
            political_influence >= 50
        }
        on_completion = {
            trigger_event = me_meshwesh.2
            show_as_tooltip = {
                c:BAR = {
                    create_unit = {
                        navy = no
                        name = "Libyan Migration I"
                        set_as_commander = scope:libyan_rebel_scope
                        location = p:5552
                        hidden_effect = {
                            add_subunit = light_infantry
                            add_subunit = camels
                            add_subunit = camels
                            add_subunit = camels
                            add_subunit = light_infantry
                            add_subunit = light_infantry 
                            add_subunit = light_infantry    
                            add_subunit = camels
                            add_subunit = light_infantry
                            add_subunit = archers 
                            add_subunit = archers                                   
                            add_food = 100
                            add_morale = 2
                        }
                    }
                    create_unit = {
                        navy = no
                        name = "Libyan Migration II"
                        location = p:5555
                        hidden_effect = {
                            add_subunit = light_infantry
                            add_subunit = camels
                            add_subunit = camels
                            add_subunit = camels
                            add_subunit = light_infantry
                            add_subunit = light_infantry 
                            add_subunit = light_infantry    
                            add_subunit = camels
                            add_subunit = light_infantry
                            add_subunit = archers 
                            add_subunit = archers                                   
                            add_food = 100
                            add_morale = 2
                        }
                    }
                    create_unit = {
                        navy = no
                        name = "Libyan Migration III"
                        location = p:3373
                        hidden_effect = {
                            add_subunit = light_infantry
                            add_subunit = camels
                            add_subunit = camels
                            add_subunit = camels
                            add_subunit = light_infantry
                            add_subunit = light_infantry 
                            add_subunit = light_infantry                               
                            add_food = 100
                            add_morale = 2
                        }
                    }
                    create_unit = {
                        navy = no
                        name = "Libyan Migration IV"
                        location = p:5555
                        hidden_effect = {
                            add_subunit = light_infantry
                            add_subunit = camels
                            add_subunit = camels
                            add_subunit = camels
                            add_subunit = light_infantry
                            add_subunit = light_infantry 
                            add_subunit = light_infantry    
                            add_subunit = camels
                            add_subunit = light_infantry
                            add_subunit = archers 
                            add_subunit = archers                                   
                            add_food = 100
                            add_morale = 2
                        }
                    }
                    create_unit = {
                        navy = no
                        name = "Libyan Migration V"
                        location = p:5547
                        hidden_effect = {
                            add_subunit = light_infantry
                            add_subunit = camels
                            add_subunit = camels
                            add_subunit = camels
                            add_subunit = light_infantry
                            add_subunit = light_infantry 
                            add_subunit = light_infantry    
                            add_subunit = camels
                            add_subunit = light_infantry
                            add_subunit = archers 
                            add_subunit = archers                                   
                            add_food = 100
                            add_morale = 2
                        }
                    }
                    create_unit = {
                        navy = no
                        name = "Libyan Migration VI"
                        location = p:5527
                        hidden_effect = {
                            add_subunit = light_infantry
                            add_subunit = camels
                            add_subunit = camels
                            add_subunit = camels
                            add_subunit = light_infantry
                            add_subunit = light_infantry 
                            add_subunit = light_infantry                               
                            add_food = 100
                            add_morale = 2
                        }
                    }
                }
                p:6499 = {
                    add_province_modifier = {
                        name = major_barbarian_spawn_place
                        duration = -1
                    }
                }
            }
        }
    }
    meshwesh_missions_task_3 = { # Oasitae Way
        icon = "task_religion"
        requires = { meshwesh_missions_task_1 }
        highlight = {
            scope:province = {
                province_id = 5537
            }
        }
        allow = {
            OR = {
                has_deity_in_pantheon = deity:omen_ammon
                has_deity_in_pantheon = deity:omen_amun
            }
        }
        on_completion = {
            trigger_event = me_meshwesh.3
            show_as_tooltip = {
                add_country_modifier = {
                    name = oasitae_way
                    duration = -1
                }
            }
        }
    }
    meshwesh_missions_task_4 = { # Prolific Piracy
        icon = "task_expansion"
        requires = { meshwesh_missions_task_1 }
        highlight = {
            scope:province = {
                OR = {
                    is_in_area = marmarica_orientalis_area
                    is_in_area = western_delta_area
                    province_id = 3373
                    province_id = 3373
                    province_id = 3372
                    province_id = 3371
                    province_id = 3370
                    province_id = 3369
                    province_id = 3368
                }
            }
        }
        allow = {
            num_of_ships >= 30
            custom_tooltip = {
                c:EGY = {
                    any_owned_province = {
                        has_province_modifier = port_province_raided
                    }
                }
                text = raid_ptolemy_tt
            }
        }
        on_completion = {
            trigger_event = me_meshwesh.4
            show_as_tooltip = {
                add_treasury = 250
                add_manpower = 2
                create_country_treasure = {
                    key = stolen_ptolemy_treasure
                    icon = treasure_chest
                    modifier = {
                        local_tax_modifier = 0.15
                    }
                }
            }
        }
    }
    meshwesh_missions_task_5 = { # The Libyan Menace
        icon = "task_battle"
        duration = 180
        requires = { meshwesh_missions_task_2 meshwesh_missions_task_3 meshwesh_missions_task_4 }
        allow = {}
        on_start = {
            trigger_event = me_meshwesh.50
            trigger_event = {
                id = me_meshwesh.501
                days = { 20 30 }
            }
        }
        on_completion = {
            trigger_event = me_meshwesh.5
            show_as_tooltip = {

            }
            set_variable = libyan_menace
        }
    }
    meshwesh_missions_task_6 = { # Enemy of my Enemy
        icon = "task_political"
        duration = 180
        potential = { has_variable = libyan_menace }
        requires = { meshwesh_missions_task_5 }
        allow = {
            diplomatic_stance = appeasement_stance
        }
        highlight = {
            scope:province = {
                OR = {
                    owner = c:SEL
                    owner = c:KSH
                    owner = c:GAR
                }
            }
        }
        bypass = {
            war_with = c:EGY
        }
        on_completion = {
            trigger_event = me_meshwesh.6
            show_as_tooltip = {

            }
        }
    }
    meshwesh_missions_task_7 = { # Offers for Officers
        icon = "task_economical"
        duration = 30
        potential = { has_variable = libyan_menace }
        requires = { meshwesh_missions_task_5 }
        allow = {
            treasury >= 150
            custom_tooltip = {
                text = any_friends_tt
                c:EGY = {
                    any_character = {
                        is_female = no
                        is_adult = yes
                        is_ruler = no
                        is_governor = yes
                        is_friend = root.current_ruler
                    }
                }
            }
        }
        on_completion = {
            trigger_event = me_meshwesh.7
            show_as_tooltip = {

            }
        }
    }
    meshwesh_missions_task_8 = {
        icon = "task_conquest"
        duration = 90
        potential = { has_variable = libyan_menace }
        requires = { meshwesh_missions_task_5 }
        allow = {
            political_influence >= 50
            manpower >= 1.5
        }
        on_completion = {
            trigger_event = me_meshwesh.8
            show_as_tooltip = {

            }
        }
    }
    meshwesh_missions_task_9 = {
        icon = "task_heracles"
        potential = { has_variable = libyan_menace }
        requires = { meshwesh_missions_task_6 meshwesh_missions_task_7 meshwesh_missions_task_8 }
        allow = {}
        on_completion = {
            trigger_event = me_meshwesh.9
            show_as_tooltip = {

            }
        }
        final = yes
    }
    meshwesh_missions_task_10 = { # Fake Task
        icon = "task_political"
        potential = { NOT = { has_variable = libyan_menace } }
        requires = { meshwesh_missions_task_5 }
        allow = {
            custom_tooltip = {
                text = fake_task_tt
                always = no
            }
        }
        on_completion = {
            trigger_event = me_meshwesh.10
            show_as_tooltip = {

            }
        }
        final = yes
    }
#    meshwesh_missions_task_11 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.11
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_12 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.12
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_13 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.13
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_14 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.14
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_15 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.15
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_16 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.16
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_17 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.17
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_18 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.18
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_19 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.19
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_20 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.20
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_21 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.21
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_22 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.22
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_23 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.23
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_24 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.24
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_25 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.25
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_26 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.26
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_27 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.27
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_28 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.28
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_29 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.29
#            show_as_tooltip = {
#
#            }
#        }
#    }
#    meshwesh_missions_task_30 = {
#        icon = "task_political"
#        allow = {}
#        on_completion = {
#            trigger_event = me_meshwesh.30
#            show_as_tooltip = {
#
#            }
#        }
#    }
}