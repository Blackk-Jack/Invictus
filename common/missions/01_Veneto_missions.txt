secure_venetia_mission_vnt = {
    header = "mssion_gaul"
    icon = cde_celts_battle_romans_celts

    repeatable = no

    chance = { factor = 5 }

    potential = {
        NOT = { has_variable = secure_venetia_mission }
        has_civil_war = no
        OR = {
		    primary_culture = venetic
		    tag = VNT
		}
    }

    abort = {
        ai_mission_back_out_trigger = yes
    }

    on_potential = { }

    on_start = {
        start_mission_ai_effect = yes
		area:ferraria_area = {
            add_provincial_claim_effect = yes
		}
    }

    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = secure_venetia_mission
            days = 7300
        }
    }

    on_completion = {
        complete_mission_effect = yes
    }


    secure_venetia_mission_task_1 = { # Take Adria
        icon = task_expansion

		allow = { 
    		area:ferraria_area = {
    			any_area_province = {
	    			count = all
	    			owned_or_subject_owned = root
    			}
    		}
		}

		highlight = { 
			scope:province = {
			    AND = {
					is_in_area = ferraria_area
					has_owner = yes
					NOT = { owner = root }	    
			    }
			}
		}

        on_completion = {  
            custom_tooltip = secure_venetia_take_adria_tt
            trigger_event = { id = secure_venetia_mission_event.1 }
		}
	}

	secure_venetia_mission_task_2 = { # Take the Mountain Pass
        icon = task_expansion
		requires = { secure_venetia_mission_task_1 }

		allow = { 
			owns_or_subject_owns = p:4024
			owns_or_subject_owns = p:4025
			owns_or_subject_owns = p:4026
		}
		
		highlight = { 			
			scope:province = {
			    AND = {
					OR = {
					    province_id = 4024
					    province_id = 4025
					    province_id = 4026
					}	
					has_owner = yes
					NOT = { owner = root }	    
			    }
			}
	    }

        on_completion = { 
            custom_tooltip = secure_venetia_take_the_mountain_pass_tt
            #Carnia becomes a city
            trigger_event = {
                id = secure_venetia_mission_event.2
            }
        }
    }

	secure_venetia_mission_task_3 = { # Fortify Este
        icon = task_economical
		requires = { secure_venetia_mission_task_2 }

		potential = { }

		allow = { 
        	trigger_if = {
        		limit = {
        			NOT = { owns = 3595 }
        		}
        		owns = 3595 
        		hidden:p:3595 = {
        			has_building = fortress_building
        		}
        	}
        	trigger_else = {
        		hidden:p:3595 = {
        			has_building = fortress_building
        		}
        	}
		}
		
		highlight = {  
            scope:province = {
                    province_id = 3595
            }
		}

        on_completion = { 
            custom_tooltip = secure_venetia_fortify_este_tt
            trigger_event = {
                id = secure_venetia_mission_event.3
            } 
        }
    }
	
	secure_venetia_mission_task_4 = { # Fortify Carnia
        icon = task_economical
		requires = { secure_venetia_mission_task_2 }

		allow = { 
        	trigger_if = {
        		limit = {
        			NOT = { owns = 4025 }
        		}
        		owns = 4025 
        		hidden:p:4025 = {
        			num_of_fortress_building >= 2
        		}
        	}
        	trigger_else = {
        		hidden:p:4025 = {
        			num_of_fortress_building >= 2
        		}
        	}
		}
		
		highlight = { 
            scope:province = {
                    province_id = 4025
            }
		}

        on_completion = { 
            custom_tooltip = secure_venetia_fortify_carnia_tt
            trigger_event = {
                id = secure_venetia_mission_event.4
            } 
		}
    }	

	secure_venetia_mission_task_5 = { # Bring in the Histrians
        icon = task_expansion
		requires = { secure_venetia_mission_task_1 }

		potential = { }

		allow = { 
			owns_or_subject_owns = p:4019
			owns_or_subject_owns = p:4018
			owns_or_subject_owns = p:4022
			owns_or_subject_owns = p:4020
			c:HIS = {
				has_land = no
			}
		}
		
		highlight = { 			
			scope:province = {
			    OR = {
			        AND = {
					    OR = {
					        province_id = 4019
					        province_id = 4018
					        province_id = 4022
					        province_id = 4020
					    }	
					    has_owner = yes
					    NOT = { owner = root }
					}
					AND = {
					    has_owner = yes
					    owner = c:HIS
					}  	    
			    }
			}
	    }

        on_completion = {	
            custom_tooltip = secure_venetia_bring_in_the_histrians_tt
            trigger_event = {
                id = secure_venetia_mission_event.5
            } 
        }
    }	

	secure_venetia_mission_task_6 = { # Ally the Cenomani
	icon = task_diplomatic

	allow = { alliance_with = c:CNM }
	
	highlight = {
	    scope:province = {
			AND = {
				has_owner = yes
				owner = c:CNM
			}  	    
		} 
	}

	on_completion = {
        custom_tooltip = secure_venetia_ally_the_cenomani_tt
        trigger_event = {
            
            id = secure_venetia_mission_event.6
        } 
	}# plus opinion with Cenomania, if cenomania is allied with the ligoni, sends event to the Cenomani asking them to break their alliance with the Ligoni.

	bypass = {
	    OR = {
        	NOT = { exists = c:CNM }
        	c:CNM = {
        		has_land = no
        	}
        }
	}

}	

	secure_venetia_mission_task_7 = { # Gallic Colonies
        icon = task_economical
		requires = { secure_venetia_mission_task_6 }
        
		duration = 180

		allow = { # > 170 opinion with Cenomania
            treasury >= 150

		}

        on_completion = { 
            custom_tooltip = secure_venetia_gallic_colonies_tt
            add_treasury = -150									
            trigger_event = { id = secure_venetia_mission_event.7 }
        }

	bypass = {
	    OR = {
        	NOT = { exists = c:CNM }
        	c:CNM = {
        		has_land = no
        	}
        }
	}
    }

	secure_venetia_mission_task_8 = { # Adopt Gallic Warfare
	icon = task_expansion
	requires = { secure_venetia_mission_task_7 }

	allow = { #Integrate lepontic culture 
	    OR = {
            alliance_with = c:CNM
            AND = {
                owns_or_subject_owns = p:3584
        	    owns_or_subject_owns = p:3581
                c:CNM = {
        		   has_land = no
        	    }   
            }
        }
        any_country_culture = {
			is_integrated = yes
			this.culture  = culture:lepontic
		}
	}

	on_completion = { 
	    custom_tooltip = secure_venetia_adopt_gallic_warfare_tt				
        trigger_event = { id = secure_venetia_mission_event.8 }
	} 

}

	secure_venetia_mission_task_9 = { # Ally the Romans
	icon = task_diplomatic
	requires = { secure_venetia_mission_task_6 }
	prevented_by = { secure_venetia_mission_task_11 }

	allow = { alliance_with = c:ROM }
	
	highlight = {
	    scope:province = {
			AND = {
				has_owner = yes
				owner = c:ROM
			}  	    
		}  
	}


	bypass = {
	    OR = {
	        is_subject_of = ROM
	        has_completed_mission_task = secure_venetia_mission_task_11
	    }
	}

    #ai_chance = { 8 }

	on_completion = { 
	    custom_tooltip = secure_venetia_ally_the_romans_tt	
        trigger_event = { id = secure_venetia_mission_event.9 }
	}
    }

	secure_venetia_mission_task_10 = { # Swear Fealty to Rome
	icon = task_diplomatic
	requires = { secure_venetia_mission_task_9 }
	prevented_by = { secure_venetia_mission_task_12 secure_venetia_mission_task_13 }

	allow = { 
	    diplomatic_stance = appeasement_stance 
	    any_neighbour_country = { tag = ROM	}          
	}

	bypass = {
		OR = {
			has_completed_mission_task = secure_venetia_mission_task_12
			has_completed_mission_task = secure_venetia_mission_task_13
		}
	}
    
    ai_chance = { factor = 80 }

	on_completion = { 
	    custom_tooltip = secure_venetia_swear_fealty_to_rome_tt				
        trigger_event = { id = secure_venetia_mission_event.10 }
	}
    }

	secure_venetia_mission_task_11 = { # Ally the Etruscans
	icon = task_diplomatic
	requires = { secure_venetia_mission_task_6 }
	prevented_by = { secure_venetia_mission_task_9 }

	allow = { alliance_with = c:ETR }
	
	highlight = {
	    scope:province = {
			AND = {
				has_owner = yes
				owner = c:ETR
			}  	    
		}   
	}

	bypass = {
		OR = {
	        is_subject_of = ROM
	        has_completed_mission_task = secure_venetia_mission_task_9
	    }
	}

    ai_chance = { factor = 20 }

	on_completion = { 
	    custom_tooltip = secure_venetia_ally_the_etruscans_tt				
        trigger_event = { id = secure_venetia_mission_event.11 }
	}
    }

	secure_venetia_mission_task_12 = { # Etruscan Protection
	icon = task_political
	requires = { secure_venetia_mission_task_11 }
	prevented_by = { secure_venetia_mission_task_10 secure_venetia_mission_task_13 }

	allow = { 
	    diplomatic_stance = appeasement_stance 
	    any_neighbour_country = { tag = ETR	} 	           
	}

	bypass = {
		OR = {
			has_completed_mission_task = secure_venetia_mission_task_10
			has_completed_mission_task = secure_venetia_mission_task_13
		}
	}

	on_completion = { 
	    custom_tooltip = secure_venetia_etruscan_protection_tt				
        trigger_event = { id = secure_venetia_mission_event.12 }
	}
    }

	secure_venetia_mission_task_13 = { # Sovereign Supremacy 
	icon = task_expansion
	requires = { secure_venetia_mission_task_9 secure_venetia_mission_task_11 }
	prevented_by = { secure_venetia_mission_task_10 secure_venetia_mission_task_12 }

	potential = { }

	allow = { 
	    diplomatic_stance = warmongering_stance
	    OR  = {
	        AND = {
	            c:ETR = { has_land = no }
	            c:ROM = { has_land = no }
	        }
	        any_neighbour_country = { tag = ETR	}
	        any_neighbour_country = { tag = ROM	}
	    }
	}

	bypass = {
		OR = {
			has_completed_mission_task = secure_venetia_mission_task_10
			has_completed_mission_task = secure_venetia_mission_task_12
		}
	}

	on_completion = { 
    	custom_tooltip = secure_venetia_sovereign_supremacy_tt				
        trigger_event = { id = secure_venetia_mission_event.13 }      
	} # Casus belli cost reduction, -50 opinion with Rome and Etruria

    }

	secure_venetia_mission_task_14 = { # Favorable Diplomacy
	icon = task_diplomatic
	requires = { secure_venetia_mission_task_10 secure_venetia_mission_task_12 secure_venetia_mission_task_13 }

	potential = { }

	allow = {
	    OR = {
		    OR = {
			    is_subject_of = ROM
			    is_subject_of = ETR
		    }
		    AND = { 
		        is_subject = no
		        diplomatic_stance = warmongering_stance
		        OR = {
    		        c:ETR = { 
		            opinion = {
		                target = ROOT
		                value >= 100
		                }
		            }
		            c:ROM = { 
		                opinion = {
		                    target = ROOT
		                    value >= 100
		                }   
		            }
		            AND = {
		                c:ROM = { has_land = no }
		                c:ETR = { has_land = no }
		            }
		        }
		    }
	    }
	}

	on_completion = { 
    	custom_tooltip = secure_venetia_favorable_diplomacy_tt				
        trigger_event = { id = secure_venetia_mission_event.14 } 
	} 

    }

	secure_venetia_mission_task_15 = { # Venetian Security 
	icon = task_expansion	
	requires = { secure_venetia_mission_task_3 secure_venetia_mission_task_4 secure_venetia_mission_task_14 }

	potential = { }

	allow = { 
	    area:ferraria_area = {
    		any_area_province = {
	    		count = all
	    		owned_or_subject_owned = root
    		}
    	}
    	area:venetia_area = {
    		any_area_province = {
	    		count = all
	    		owned_or_subject_owned = root
    		}
    	}
	    war = no
	    stability >= 50
	}
	
	highlight = {  
			scope:province = {
			    AND = {
			        OR = {
						is_in_area = ferraria_area
						is_in_area = venetia_area		        
				    }
					has_owner = yes
					NOT = { owner = root }	    
			    }
			}
	}

	on_completion = { 
    	custom_tooltip = secure_venetia_venetian_security_tt				
        trigger_event = { id = secure_venetia_mission_event.15 } 

	} # Global Fort Defense

	final = yes
    }

    secure_venetia_mission_task_16 = { # Roman culture
 	icon = task_expansion
 	requires = { secure_venetia_mission_task_10 }

 	allow = {
 	    is_subject_of = ROM
 	    any_neighbour_country = { tag = ROM	}
 	    p:1 = {
 	       civilization_value >= 40
 	    }  
 	    c:ROM = {
 	        num_of_provinces >= 10
 	    }
 	}
	on_completion = { 
    	custom_tooltip = secure_venetia_roman_culture_tt				
        trigger_event = { id = secure_venetia_mission_event.21 }      
	}  
}	  

secure_venetia_mission_task_17 = { # Push Into Illyria
 	icon = task_conquest
 	requires = { secure_venetia_mission_task_5 secure_venetia_mission_task_19 }

 	allow = {
 	    is_subject = no
    	area:histria_area = {
    		any_area_province = {
	    		count = all
	    		owned_or_subject_owned = root
    		}
    	}
 	}

    highlight = {
 		scope:province = {
			AND = {
				is_in_area = histria_area
				has_owner = yes
				NOT = { owner = root }	    
			}
		}   
    }

	on_completion = { 
    	custom_tooltip = secure_venetia_push_into_illyria_tt				
        trigger_event = { id = secure_venetia_mission_event.24 }      
	}  	
}

secure_venetia_mission_task_18 = { # Conquer the Illyrian Coast
 	icon = task_happiness
 	requires = { secure_venetia_mission_task_17 }

 	allow = {
    	area:dalmatia_occidentalis_area = {
    		any_area_province = {
	    		count = all
	    		owned_or_subject_owned = root
    		}
    	}
    	area:dalmatia_centralis_area = {
    		any_area_province = {
	    		count = all
	    		owned_or_subject_owned = root
    		}
    	}
 	}

    highlight = {
		scope:province = {
			AND = {
			    OR = {
				is_in_area = dalmatia_occidentalis_area
				is_in_area = dalmatia_centralis_area
			    }
				has_owner = yes
				NOT = { owner = root }	    
			}
		}
    }

	on_completion = { 
    	custom_tooltip = secure_venetia_conquer_the_illyrian_coast_tt				
        trigger_event = { id = secure_venetia_mission_event.25 }      
	} 
}

secure_venetia_mission_task_19 = { # Direct Control over Cenomannia
 	icon = task_expansion
 	requires = { secure_venetia_mission_task_1 secure_venetia_mission_task_13 }

 	allow = {
    	area:cenomannia_area = {
    		any_area_province = {
	    		count = all
	    		owned_or_subject_owned = root
    		}
    	}
 	}

    highlight = {
		scope:province = {
			AND = {
				is_in_area = cenomannia_area
				has_owner = yes
				NOT = { owner = root }	    
			}
		}
    }

	on_completion = { 
    	custom_tooltip = secure_venetia_direct_control_over_cennomania_tt				
        trigger_event = { id = secure_venetia_mission_event.26 }      
	} 
}